{% block image_collection_widget %}

    {% if prototype is defined and not prototype.rendered %}
        {%- set attr = attr|merge({'data-prototype': form_row(prototype) }) -%}
    {% endif %}

    {{- block('form_widget') -}}

    {% if allow_add %}
        <div class="actions">
            <button data-form-collection-target="addButton" data-action="form-collection#addItem">
                {{ source('images/svg/icon-plus.svg') }}
            </button>
        </div>
    {% endif %}
{% endblock %}

{% block image_collection_item_widget %}

    {{ block('image_preview') }}
    {{ block('hidden_file') }}

    <div class="form-errors">
        {{ form_errors(form.file) }}
    </div>

    <div class="delete-able-image">
        {{ block('upload_label') }}

        {% if form.parent.vars.allow_delete %}
            {{ block('trash_link') }}
        {% endif %}
    </div>

    {{ form_rest(form) }}
{% endblock %}


{% block image_preview %}
    <div class="image-preview">
        {% if form.vars.value.fullPath|default(null) is not null %}
            <img src="{{ form.vars.value.fullPath|imagine_filter('form_preview') }}" alt="{{ form.vars.value.altText ?? form.vars.value.fileName }}"/>
        {% else %}
            <img src="{{ asset(placeholder_image_path) }}" alt="avatar"/>
        {% endif %}
    </div>
{% endblock %}

{% block hidden_file %}
    <div class="ui hidden element">
        {{ form_widget(form.file) }}
    </div>
{% endblock %}

{% block upload_label %}
    <label for="{{ form.file.vars.id }}" class="btn space-x-1">
        {{ source('images/svg/icon-cloud-upload.svg') }}
        <span>{{ 'ui.choose_file'|trans }}</span>
    </label>
{% endblock %}

{% block trash_link %}
    <a href="{{ delete_path ?? '#' }}"
       {% if delete_path is not defined %}data-action="form-collection#removeItem"{% endif %}>{{ source('@ControlPanel/images/icon-trash.svg') }}</a>
{% endblock %}